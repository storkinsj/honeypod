@version: 4.1

# Configure the source to read from the messages log file
# no-parse means whole line becomes "message" portion.
# Template should indicate security alert to syslog daemon
source s_honeypod {
    file("/var/log/honeypod" flags(no-parse));
};

template t_prefix {
    template("security.alert: ");
};

destination d_destination {
    <destination_address>$(arg("destination"))
};

#Set service principle
user syslognguser;

# NOTE: DESTINATION SPECIFIED ON COMMAND LINE

# Configure the log statement to route messages from the honeypod log file to 
# the syslog server specified on the command line

log {
    source(s_honeypod);
	template(t_prefix);
    destination(d_destination);
};

